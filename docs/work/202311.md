# 202311

::: info

不知道路在哪里？路在脚下，可脚下却无路可走

> 20231101

:::

## 1101

- react 版本的元素露出与隐藏以及**IntersectionObserver** API

```js
  const ExposeRef = useRef(
    new IntersectionObserver(
      (entries) => {
        entries.forEach(({ intersectionRatio, target }) => {
          if (intersectionRatio > 0.5) {
            const _target = target as HTMLImageElement;
            const ids = _target.dataset.expose ?? "";
            console.log(ids, "ids");
            setShowIndex(+ids);
          }
        });
      },
      {
        root: null,
        threshold: 0.7,
      }
    )
  );

  useEffect(() => {
    const exposeRef = ExposeRef.current;
    const everyItems = document.querySelectorAll("[data-expose]");
    if (everyItems && everyItems.length) {
      Array.from(everyItems).forEach((item) => {
        if (item) {
          exposeRef.observe(item);
        }
      });
    }
    return () => {
      exposeRef.disconnect();
    };
  }, []);
```
