# 202304

金三银四，四月你还好吗!是否虚度了阳春三月，没关系，往前看，人间四月等着你去努力

:::tip

人间四月芳菲尽，山寺桃花始盛开

:::

## 0401

- 花了半天时间成功注册了一个 Chatgpt 账户，验证手机号码花了几块钱租了一个[拉脱维亚的虚拟号进行验证](https://sms-activate.org/cashBack),随便搞个 OpenApi Key: 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, [OpenApi 后台](https://platform.openai.com/)

接下来每天积累五条面试相关经验

在前端面试中，可能会问到以下 React 相关的面试题：

介绍 React 生命周期。

React 中的组件通信方式有哪些？

什么是虚拟 DOM？如何实现虚拟 DOM？

React 中的状态管理方式有哪些？

如何优化 React 的性能？

React 中的 key 属性有什么作用？

什么是高阶组件？如何创建高阶组件？

React 中的 ref 属性有什么作用？(from gpt)

在 React 中，ref 是用于获取组件或 DOM 元素引用的属性。通过 ref，我们可以在 React 组件渲染完成之后，访问组件或 DOM 元素的属性和方法，从而实现一些 DOM 操作或组件交互。
回调函数 ref 不仅可以用来获取 DOM 元素的引用，还可以用来获取组件的**实例引用**。当使用回调函数 ref 来获取组件实例时，该回调函数的参数就是组件的实例引用。例如：

```js
import React, { Component } from "react";

class MyComponent extends Component {
  doSomething() {
    // do something
    console.log("child comp");
  }

  render() {
    return (
      <div>
        <button
          onClick={() => {
            this.props.onClick(this);
          }}
        >
          Click me
        </button>
      </div>
    );
  }
}

class App extends Component {
  handleClick = (component) => {
    component.doSomething();
  };

  render() {
    return (
      <div>
        <MyComponent onClick={this.handleClick} />
      </div>
    );
  }
}
```

React Hooks 是什么？有哪些常用的 Hooks？

什么是 Context？如何使用 Context？

介绍 React 中的路由。

React 中的事件处理方式有哪些？

如何使用 Redux 进行状态管理？

React 和 Vue 的区别有哪些？

- JIT 编译器：在 Tailwind CSS v2.1.0 及以后的版本中，Tailwind CSS 引入了一个 JIT（Just-In-Time）编译器，它的作用是**动态地生成 CSS 样式类**，这样可以大大减少 CSS 文件的大小。在运行时，JIT 编译器会根据用户的实际使用情况动态生成 CSS 样式类，并将其添加到最终的 CSS 文件中。

- [前端框架的 JIT 和 AOT 编译方案](https://mp.weixin.qq.com/s/J-13uueQVe-OBinXr669EQ)

现代前端框架都需要“编译”这一步骤，用于：

1.将框架中描述的 UI 转换为宿主环境可识别的代码

2.代码转化，比如将 ts 编译为 js、实现 polyfill 等

3.执行一些编译时优化

4.代码打包、压缩、混淆

编译可以选择放在两个时机执行：

代码构建时，被称为 **AOT（Ahead Of Time，提前编译或预编译）**，宿主环境获得的是编译后的代码

代码在宿主环境执行时，被称为 **JIT（Just In Time，即时编译）**，代码在宿主环境编译并执行

### 如何通过编译器的优化原理，如何提高 JavaScript 的执行效率？(from gpt)

编译器的优化原理主要是基于静态分析和运行时优化两个方面来实现的，可以通过以下方式来提高 JavaScript 的执行效率：

- 减少变量的使用：在 JavaScript 中，变量的使用会导致内存分配和垃圾回收等操作，从而影响代码的执行效率。因此，在编写 JavaScript 代码时，应尽量减少变量的使用。

- 避免频繁创建对象和数组：在 JavaScript 中，创建对象和数组会导致内存分配和垃圾回收等操作，从而影响代码的执行效率。因此，在编写 JavaScript 代码时，应尽量避免频繁创建对象和数组。

- 使用函数节流和函数防抖：在处理一些频繁触发的事件时，可以使用函数节流和函数防抖来优化代码的执行效率。函数节流可以控制函数的执行频率，从而避免频繁的操作，而函数防抖可以在一定的延迟时间之后执行函数，从而避免重复执行。

- 使用 Web Worker：Web Worker 可以在独立的线程中执行 JavaScript 代码，从而避免阻塞主线程，提高代码的执行效率。

- 使用编译器的优化原理：编译器的优化原理可以帮助我们优化 JavaScript 代码的执行效率，例如使用 webpack、rollup 等构建工具来进行代码压缩和打包，使用 Babel 等工具进行语法转换和优化等操作，从而减少 JavaScript 代码的体积和提高代码的执行效率。

- 使用代码优化工具：使用一些代码优化工具，例如 Google 的 Closure Compiler、UglifyJS 等，可以帮助我们对 JavaScript 代码进行分析和优化，从而提高代码的执行效率。

总之，在提高 JavaScript 的执行效率时，需要结合编译器的优化原理、代码优化工具和代码编写习惯等多个方面进行综合优化。

### JavaScript 是如何执行的？(from gpt)

JavaScript 的执行过程可以分为两个阶段：编译阶段和执行阶段。

编译阶段：在编译阶段，JavaScript 引擎会对代码进行词法分析和语法分析，生成抽象语法树（AST），并且对代码进行预编译，例如变量提升、函数声明提升等操作。在这个阶段，JavaScript 引擎会检查代码是否符合语法规范，并生成执行上下文（Execution Context）。

执行阶段：在执行阶段，JavaScript 引擎会按照编译阶段生成的执行上下文执行代码。执行上下文包含了变量、函数、作用域链等信息，JavaScript 引擎根据作用域链来查找变量和函数，并且在执行过程中进行变量赋值、函数调用等操作。在执行过程中，JavaScript 引擎会将代码分为同步任务和异步任务，同步任务会按照顺序执行，而异步任务会先被放到任务队列中，等待下一个事件循环执行。

JavaScript 引擎执行代码时，还会进行垃圾回收和优化等操作。垃圾回收是指当变量或对象不再被引用时，会被自动清除内存空间，从而避免内存泄漏。优化是指 JavaScript 引擎会根据代码的执行情况进行优化，例如 JIT 编译、预解析等操作，从而提高代码的执行效率。

总之，JavaScript 的执行过程是一个编译和执行的过程，通过编译阶段和执行阶段的协同工作，JavaScript 能够完成对代码的解析和执行。

### 说下 TS 中的泛型(from gpt)

在 TypeScript 中，泛型允许我们在定义函数、类或接口时不预先指定类型，而是在使用时再动态指定类型，以增加代码的灵活性和复用性。(定义时不指定具体类型)

泛型的基本语法是使用尖括号`<T>`（T 可以替换为任意标识符），将类型参数声明在函数或类名之后

```ts
class GenericNumber<T> {
  zeroValue: T;
  add: (x: T, y: T) => T;
}

let myGenericNumber = new GenericNumber<number>();
myGenericNumber.zeroValue = 0;
myGenericNumber.add = function (x, y) {
  return x + y;
};
```

## 0402

- modern.js 中的 NoSSR

```ts
import { useEffect, useState } from "react";

export function NoSSR(props: { children: React.ReactNode }) {
  const { children } = props;
  const [isMounted, setIsMounted] = useState(false);

  useEffect(() => {
    setIsMounted(true);
  }, []);

  if (!isMounted) {
    return null;
  } else {
    return <>{children}</>;
  }
}
```

## 0402

### 每日一题：面试官问，说下 react fiber 原理

React Fiber 是 React v16 中引入的新的协调引擎，它的目标是提高 React 的渲染性能和用户体验。

传统的 React 渲染方式是基于递归调用的，这种方式存在一些问题，比如在渲染大量组件时会造成主线程阻塞，影响用户体验。React Fiber 的出现解决了这个问题，它使用了一种新的调度算法，将渲染工作分解为多个阶段，每个阶段可以中断和恢复，从而实现了优先级控制和异步渲染，提高了 React 的渲染性能和用户体验。

React Fiber 的实现原理如下：

- 构建 Fiber 树：在渲染过程中，React 会创建一颗 Fiber 树，表示所有需要更新的组件以及它们的关系。与传统的虚拟 DOM 不同的是，Fiber 树不仅包含组件的结构，还包含组件的状态、生命周期等信息。

- 调度更新：当组件状态发生变化时，React 会根据优先级调度更新，将更新任务分解成多个阶段，每个阶段对应一个优先级。React 会根据优先级和剩余时间来决定当前阶段能否执行，从而实现优先级控制和异步渲染。

- 执行更新：当当前阶段可以执行时，React 会遍历 Fiber 树，执行对应阶段的更新任务。React Fiber 引入了一种新的数据结构叫做 FiberNode，用来描述每个需要更新的组件，包含组件的类型、props、state 等信息。遍历 Fiber 树时，React Fiber 会根据 FiberNode 之间的关系执行更新任务，并将更新结果保存在 FiberNode 中。

- 提交更新：当所有阶段的更新任务都执行完毕时，React Fiber 会将更新结果一次性提交到浏览器中，实现视图的更新。React Fiber 还引入了另一种新的数据结构叫做 SideEffect，用来保存更新过程中产生的副作用，比如需要插入、删除或更新 DOM 元素。在提交更新时，React Fiber 会根据 SideEffect 进行批量操作，减少浏览器的重绘和回流，提高性能。

总之，React Fiber 的实现原理主要是基于优先级调度、阶段分解、中断恢复和批量更新等技术，通过这些技术实现了高效的异步渲染和优先级控制。
